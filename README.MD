# Berkut Security Search

Berkut Security Search — это веб-приложение, предназначенное для проверки поисковых запросов на соответствие базе данных запрещённых материалов, чтобы обеспечить соблюдение правил контента. Приложение предоставляет удобный интерфейс для ввода запросов, отображает индикатор выполнения во время проверки и перенаправляет безопасные запросы на популярные поисковые системы (Google, Yandex, DuckDuckGo). Для обнаружения запрещённого контента используются полнотекстовый поиск (FTS5) и векторный семантический поиск.

Этот проект распространяется под лицензией [Mozilla Public License 2.0](https://mozilla.org/MPL/2.0/).

## Возможности
- **Проверка запросов**: Проверяет введённые пользователем запросы на наличие запрещённых материалов.
- **Прогресс в реальном времени**: Отображает индикатор выполнения проверки с использованием Server-Sent Events (SSE).
- **Интеграция с поисковыми системами**: Перенаправляет безопасные запросы в Google, Yandex или DuckDuckGo одним кликом.
- **Современный интерфейс**: Чистый, адаптивный интерфейс с тёмной темой, использующий Tailwind CSS и шрифт Inter.
- **Поддержка базы данных**: Использует SQLite с FTS5 для эффективного текстового поиска и поддерживает ввод данных из файлов CSV или текстовых файлов.

## Установка

### Требования
- Python 3.8 или выше
- SQLite
- Необходимые Python-библиотеки (перечислены в `requirements.txt`):
  - `flask`
  - `sentence-transformers`
  - `pandas`
  - `numpy`

### Настройка
1. **Клонирование репозитория**:
   ```bash
   git clone https://github.com/berkutsolutions/berkut-security-search.git
   cd berkut-security-search
   ```

2. **Установка зависимостей**:
   ```bash
   pip install -r requirements.txt
   ```

3. **Подготовка базы данных**:
   - Поместите данные о запрещённых материалах в файл `fs_em.csv` (формат CSV с колонками: `№`, `Дата`, `Материал`) или `fs_em.txt` (текстовый формат с записями, разделёнными строкой "Экстремистский материал №").
   - Запустите скрипт инициализации базы данных:
     ```bash
     python database.py
     ```
     Это создаст базу данных SQLite (`restricted.db`) с данными о запрещённых материалах.

4. **Запуск приложения**:
   - Для режима полнотекстового поиска:
     ```bash
     python run.py
     ```
   - Для режима векторного семантического поиска:
     ```bash
     python app.py
     ```

5. **Доступ к приложению**:
   - Откройте веб-браузер и перейдите по адресу `http://127.0.0.1:5000`.

### Структура файлов
- `run.py`: Основной скрипт приложения для полнотекстового поиска с использованием FTS5.
- `app.py`: Альтернативный скрипт для векторного семантического поиска с использованием SentenceTransformer.
- `database.py`: Скрипт для инициализации базы данных SQLite из CSV или текстового файла.
- `index.html`: Шаблон веб-интерфейса, стилизованный с помощью Tailwind CSS и шрифта Inter.
- `fs_em.csv` или `fs_em.txt`: Входные файлы с данными о запрещённых материалах (не включены).
- `restricted.db`: База данных SQLite (создаётся скриптом `database.py`).
- `requirements.txt`: Список Python-зависимостей.

## Использование
1. Откройте веб-интерфейс по адресу `http://127.0.0.1:5000`.
2. Введите поисковый запрос в поле ввода и нажмите кнопку "Поиск".
3. Приложение проверяет запрос на наличие запрещённого контента в базе данных:
   - Во время проверки отображается индикатор выполнения.
   - Если запрос безопасен, отображается сообщение "Запрос безопасен!" с возможностью перейти к поиску в Google, Yandex или DuckDuckGo.
   - Если обнаружен запрещённый контент, отображается предупреждение с деталями (ID, дата и причина).
4. Для безопасных запросов нажмите на иконки поисковых систем, чтобы перейти к поиску в соответствующей системе.

## Настройка
- **Путь к базе данных**: Измените путь в файлах `run.py`, `app.py` и `database.py`, если файлы `restricted.db`, `fs_em.csv` или `fs_em.txt` находятся не в папке `C:\Users\berkut\Desktop\search\`.
- **Порог сходства**: В `app.py` настройте порог сходства (по умолчанию: `0.7`) для чувствительности векторного поиска.
- **Порт и хост**: Измените `app.run(host='127.0.0.1', port=5000)` в `run.py` или `app.py`, если требуется другой хост или порт.

## Лицензия
Этот исходный код распространяется на условиях Mozilla Public License, v. 2.0. Если копия лицензии не была предоставлена вместе с этим файлом, вы можете получить её по адресу: https://mozilla.org/MPL/2.0/.

## Контакты
Для вопросов или проблем создайте issue в репозитории GitHub: [https://github.com/berkutsolutions/berkut-security-search](https://github.com/berkutsolutions/berkut-security-search).
